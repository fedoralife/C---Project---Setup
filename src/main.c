#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f script.sh o main 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\244"
#define      opts_z	1
#define      opts	((&data[1]))
	"\202"
#define      text_z	5385
#define      text	((&data[864]))
	"\070\346\342\232\303\036\141\345\206\107\326\245\252\024\164\346"
	"\236\133\323\212\167\324\072\015\221\346\216\163\233\062\025\323"
	"\030\367\155\334\026\317\302\234\027\230\102\301\255\266\250\114"
	"\021\174\326\211\120\021\226\342\367\045\125\222\127\153\145\160"
	"\142\323\114\171\243\017\025\272\247\127\174\125\015\045\241\037"
	"\241\167\250\362\210\077\324\200\144\051\022\274\225\167\054\370"
	"\113\171\161\356\210\206\250\060\336\045\205\354\112\047\013\353"
	"\237\264\335\050\364\261\250\130\333\272\025\160\062\101\150\175"
	"\273\332\154\103\140\025\164\077\072\372\053\204\041\067\160\300"
	"\353\115\351\337\377\221\070\333\113\115\114\176\217\265\374\113"
	"\217\150\216\360\175\003\057\267\375\132\074\037\221\254\340\175"
	"\372\311\135\371\132\225\325\246\343\041\044\163\326\040\276\145"
	"\210\115\125\006\120\205\276\116\337\372\155\161\246\115\357\241"
	"\027\114\232\161\342\157\027\306\221\074\071\147\135\370\315\346"
	"\105\042\354\226\247\252\345\207\245\122\371\114\240\350\355\267"
	"\065\207\051\030\367\101\336\210\175\030\360\333\020\275\301\126"
	"\340\255\355\207\130\322\017\375\044\010\111\305\361\066\175\046"
	"\276\246\077\266\350\035\077\146\066\057\101\106\355\002\235\315"
	"\260\212\125\010\134\144\006\201\155\117\106\136\206\304\205\105"
	"\153\304\373\123\342\073\271\030\152\372\137\130\375\374\045\255"
	"\207\173\266\343\337\274\144\115\014\253\253\222\157\061\327\332"
	"\366\323\056\330\016\347\360\171\342\120\321\337\114\367\215\323"
	"\162\103\267\122\377\034\237\013\307\113\236\067\174\165\022\162"
	"\111\100\113\130\050\073\321\012\213\243\352\330\233\167\254\016"
	"\272\143\140\272\200\000\306\110\113\144\177\310\332\222\073\043"
	"\323\206\174\373\302\115\006\116\361\361\046\215\150\323\233\043"
	"\067\374\336\267\374\244\377\110\011\177\020\343\022\113\007\345"
	"\322\203\341\224\321\350\342\303\331\011\120\102\334\353\145\023"
	"\350\104\313\344\350\312\054\361\112\075\325\134\211\334\102\133"
	"\140\043\360\061\013\322\364\345\334\105\047\270\061\215\314\031"
	"\321\227\376\272\142\052\254\255\150\201\011\361\136\113\115\277"
	"\157\075\360\173\020\345\140\354\053\207\245\134\024\162\166\346"
	"\012\164\240\154\237\114\031\007\316\043\371\055\157\106\354\336"
	"\204\335\131\224\303\272\201\356\101\046\112\126\231\301\074\243"
	"\065\334\020\325\051\052\335\370\115\326\045\274\035\022\233\241"
	"\357\365\066\262\257\267\240\360\336\353\106\167\255\203\033\342"
	"\137\053\270\211\125\225\201\242\153\247\137\211\272\373\052\251"
	"\360\141\134\237\031\375\220\367\351\327\157\226\132\213\171\272"
	"\266\061\103\013\306\305\256\062\155\016\273\047\011\346\320\372"
	"\110\055\231\141\052\052\131\024\001\311\252\133\124\044\025\012"
	"\125\131\026\034\036\305\117\213\324\013\262\335\362\203\330\072"
	"\260\161\234\333\233\365\357\235\276\232\370\023\276\015\035\024"
	"\146\064\060\205\371\200\020\315\213\303\253\175\106\204\270\367"
	"\365\124\323\221\111\303\056\010\135\047\033\034\065\071\060\234"
	"\155\141\041\147\341\062\065\154\365\341\352\074\145\242\064\133"
	"\366\010\355\100\313\033\111\051\103\145\105\170\237\166\024\014"
	"\327\065\164\270\147\252\045\135\213\017\231\361\262\316\114\251"
	"\326\071\352\241\125\064\312\230\231\020\020\070\206\045\105\136"
	"\132\272\026\302\144\074\037\360\114\271\341\377\207\055\250\136"
	"\147\222\000\275\307\312\125\140\333\146\231\142\213\337\300\346"
	"\231\327\250\375\023\310\356\140\202\317\137\011\375\007\150\145"
	"\232\150\042\141\063\170\302\016\337\133\160\152\073\061\120\324"
	"\010\371\322\033\302\300\173\104\220\332\115\215\342\266\362\174"
	"\036\025\336\121\215\240\140\154\374\321\327\067\002\050\324\321"
	"\036\012\065\157\302\275\374\300\234\333\065\347\204\167\326\046"
	"\064\227\230\355\030\302\127\163\204\203\315\244\310\133\331\217"
	"\214\340\055\033\206\207\207\026\112\104\320\140\056\055\046\373"
	"\220\024\344\070\270\323\145\341\160\374\165\102\160\060\014\343"
	"\153\046\320\322\267\315\155\054\106\065\364\012\011\321\365\046"
	"\343\305\343\307\207\052\120\167\073\000\344\365\216\273\353\102"
	"\375\223\332\165\300\026\227\274\106\310\144\132\314\272\223\132"
	"\200\206\220\070\312\070\253\321\322\000\125\314\325\247\111\111"
	"\375\152\074\064\170\045\141\234\135\166\025\315\323\073\123\001"
	"\132\116\166\264\320\111\340\262\354\056\203\033\022\167\152\063"
	"\352\315\001\342\316\110\000\366\370\233\163\141\363\066\214\015"
	"\155\275\366\151\343\321\175\320\135\301\236\221\115\351\327\232"
	"\175\076\341\016\042\341\171\315\025\306\367\245\007\271\273\013"
	"\212\154\001\367\010\143\170\047\176\025\154\327\213\164\316\324"
	"\200\034\045\204\250\020\336\330\173\222\044\306\332\350\062\324"
	"\361\211\170\235\362\351\357\215\201\310\223\054\166\150\217\006"
	"\335\362\037\020\064\264\256\276\051\205\000\364\166\014\205\021"
	"\252\331\066\135\345\005\115\141\047\145\053\346\265\026\201\335"
	"\374\262\161\300\115\111\317\057\106\227\363\032\000\317\065\126"
	"\001\026\012\177\264\335\003\206\037\322\122\100\075\375\004\126"
	"\167\136\154\214\155\300\001\016\226\074\171\000\224\037\137\057"
	"\017\251\344\006\150\051\163\032\323\333\136\265\024\312\322\257"
	"\137\053\134\120\262\277\260\130\352\321\176\024\201\074\055\377"
	"\252\040\155\114\243\100\236\333\247\321\046\021\116\075\066\271"
	"\371\343\250\144\333\202\115\015\351\171\275\133\143\125\360\114"
	"\147\122\045\165\305\244\304\110\114\126\011\171\144\330\326\262"
	"\043\004\102\064\374\026\336\104\236\333\323\124\122\255\065\040"
	"\266\073\064\235\041\215\152\036\344\102\107\037\227\165\141\374"
	"\212\044\104\200\175\165\257\216\342\057\033\011\265\151\135\256"
	"\032\144\275\051\373\157\270\075\125\026\063\251\313\107\130\027"
	"\314\375\046\065\117\070\333\235\213\037\073\140\227\051\214\100"
	"\063\243\031\102\335\167\066\255\266\056\022\372\156\230\363\122"
	"\314\214\355\161\333\176\342\105\062\206\366\176\310\246\071\060"
	"\033\264\332\302\375\142\077\052\125\144\172\041\033\325\172\144"
	"\171\011\033\174\043\155\227\106\001\146\370\025\222\110\021\156"
	"\130\330\207\234\171\035\270\224\335\305\256\204\271\263\324\273"
	"\157\027\234\134\317\272\266\325\017\325\040\322\364\050\373\052"
	"\204\167\070\220\277\023\306\013\224\340\314\120\373\206\156\265"
	"\271\115\373\027\151\324\340\031\031\235\262\370\205\203\106\072"
	"\101\367\011\265\233\044\361\316\100\071\276\170\167\363\151\346"
	"\066\207\153\343\321\012\360\357\212\073\104\205\353\006\173\201"
	"\173\367\051\106\056\326\032\100\047\177\337\047\214\371\170\023"
	"\271\072\170\252\150\066\277\031\146\242\034\007\302\316\364\345"
	"\236\013\133\331\043\047\024\253\114\015\226\371\124\312\137\133"
	"\254\144\175\267\105\057\270\360\203\175\013\320\144\370\113\266"
	"\306\333\244\276\062\322\160\033\353\042\227\060\307\153\321\241"
	"\340\126\207\312\330\102\061\301\125\252\222\274\136\257\014\201"
	"\012\313\102\140\076\172\317\263\275\266\070\325\354\353\073\341"
	"\173\357\367\052\207\340\127\170\110\350\341\151\250\243\130\166"
	"\046\002\372\016\076\201\016\216\037\301\001\015\077\332\130\142"
	"\317\041\200\062\365\217\150\073\275\241\245\006\275\302\334\160"
	"\204\373\162\126\347\135\160\115\023\067\130\113\177\013\241\006"
	"\165\174\054\164\100\130\124\141\014\135\143\220\203\302\215\257"
	"\210\031\221\167\306\113\240\075\044\202\245\345\001\261\307\114"
	"\237\116\152\236\344\122\034\147\234\051\133\251\141\061\342\321"
	"\237\200\173\047\157\362\267\253\322\246\106\325\202\246\122\205"
	"\154\321\071\223\323\002\120\057\267\230\317\354\012\217\330\320"
	"\032\340\032\231\336\301\161\272\241\142\137\340\262\027\010\327"
	"\201\303\234\105\177\060\255\324\332\155\151\357\245\361\033\367"
	"\357\357\271\277\021\066\124\326\006\021\240\324\104\014\341\205"
	"\036\132\021\030\305\166\034\254\375\364\004\330\154\343\224\100"
	"\174\325\305\010\231\005\304\043\262\165\174\015\312\034\120\372"
	"\216\011\056\046\033\301\100\125\305\354\103\116\130\173\140\021"
	"\130\370\154\156\335\021\215\317\126\054\071\350\062\367\146\030"
	"\360\246\030\250\023\157\315\124\252\041\212\007\157\100\206\303"
	"\153\124\221\206\151\373\117\100\002\157\301\324\174\075\157\150"
	"\152\050\012\265\211\314\207\350\266\337\225\347\264\104\016\112"
	"\115\137\150\241\230\105\224\206\263\173\274\156\103\244\255\024"
	"\251\007\356\033\053\127\013\110\010\221\225\056\105\063\235\021"
	"\026\141\057\330\363\027\040\211\105\060\271\055\071\345\241\226"
	"\074\261\273\124\074\037\122\111\172\051\137\001\171\041\164\165"
	"\366\063\045\312\024\374\356\206\230\265\031\277\072\322\027\103"
	"\203\200\250\333\227\062\062\337\240\352\324\176\330\341\202\215"
	"\316\225\373\227\060\043\275\004\107\312\154\336\051\333\273\033"
	"\153\046\136\265\161\206\112\135\127\104\266\035\305\120\113\214"
	"\146\317\060\222\262\325\011\376\101\033\164\151\245\254\133\043"
	"\064\307\206\101\215\356\112\354\073\110\050\164\222\307\050\331"
	"\175\267\333\034\141\137\304\307\025\016\012\104\237\367\131\100"
	"\245\133\065\327\357\055\257\047\032\237\122\246\030\214\131\221"
	"\021\117\272\210\177\304\110\234\231\047\052\064\107\074\070\155"
	"\232\067\377\052\057\164\202\377\003\053\366\161\275\370\173\343"
	"\354\161\275\007\064\331\330\344\204\361\152\343\366\312\061\003"
	"\120\326\242\241\171\346\141\012\126\121\264\001\014\366\000\213"
	"\170\232\243\105\150\067\011\225\257\230\227\025\167\330\124\333"
	"\226\353\233\325\175\025\022\053\307\006\244\035\253\070\044\162"
	"\351\226\221\162\215\302\346\027\241\143\143\163\170\224\326\015"
	"\323\370\241\020\361\216\147\303\246\111\221\034\061\236\134\201"
	"\044\116\306\136\307\075\236\001\341\077\054\266\356\161\157\107"
	"\214\054\122\334\177\367\371\073\301\225\303\023\345\151\035\315"
	"\132\346\111\331\173\313\024\206\034\155\170\210\242\226\302\040"
	"\106\153\307\113\230\337\017\215\365\305\060\340\213\250\272\100"
	"\130\102\031\101\261\364\150\223\172\371\244\073\022\042\121\253"
	"\376\237\052\246\327\213\264\000\205\346\076\377\002\166\141\165"
	"\175\056\214\370\062\376\215\266\074\326\371\071\240\257\027\163"
	"\245\036\352\061\263\220\110\230\163\377\304\017\020\316\123\177"
	"\106\360\013\214\215\023\113\171\054\174\341\065\227\137\077\161"
	"\364\217\211\311\060\313\062\300\227\321\021\221\254\072\306\235"
	"\061\216\126\313\234\013\216\332\021\115\043\114\207\152\363\334"
	"\165\035\300\104\264\377\136\324\062\151\300\232\011\045\100\352"
	"\327\063\113\115\064\315\014\331\353\206\103\154\324\325\211\120"
	"\217\225\251\277\145\301\252\005\213\324\175\050\312\116\144\020"
	"\203\373\070\226\030\357\315\122\020\040\336\010\041\224\044\176"
	"\105\377\232\245\320\037\075\153\105\363\130\144\231\302\170\037"
	"\164\110\160\335\234\134\064\341\060\163\141\300\005\002\271\135"
	"\264\066\015\042\346\206\330\040\034\373\002\004\166\373\143\057"
	"\157\263\333\067\370\150\326\352\205\117\166\002\363\137\051\322"
	"\327\167\174\215\051\276\274\157\247\267\017\151\373\136\065\166"
	"\213\073\347\165\017\114\235\267\154\050\107\300\027\227\156\337"
	"\077\173\107\243\000\364\125\060\150\305\123\023\373\311\146\022"
	"\326\317\116\034\126\344\057\103\260\036\304\212\232\203\142\033"
	"\012\271\034\036\165\206\254\170\036\257\240\222\020\172\255\101"
	"\230\220\331\224\127\012\276\267\240\014\070\221\137\375\066\045"
	"\224\236\227\072\046\301\221\335\062\201\257\141\304\354\321\166"
	"\372\151\311\006\150\217\326\122\244\337\241\242\300\257\116\325"
	"\317\135\105\120\274\173\051\052\145\261\144\012\324\213\344\345"
	"\354\334\103\300\331\265\275\252\320\332\334\022\001\107\044\365"
	"\030\047\217\162\213\237\232\222\146\032\172\117\322\210\374\315"
	"\114\114\350\117\050\157\152\144\213\135\255\345\203\354\270\222"
	"\005\347\252\143\052\116\040\145\102\150\202\267\235\005\314\071"
	"\252\227\225\371\142\007\211\115\350\113\321\022\002\161\227\366"
	"\170\347\242\035\023\131\365\065\104\372\370\261\015\127\233\104"
	"\202\312\141\214\376\334\311\330\151\213\023\127\223\254\050\327"
	"\261\321\363\022\260\231\105\352\373\232\266\324\136\367\057\313"
	"\161\133\065\212\264\233\074\340\353\341\102\312\160\271\372\146"
	"\105\216\110\300\130\074\024\347\154\163\004\352\007\130\217\242"
	"\037\254\141\276\220\363\142\254\337\263\134\005\247\051\317\354"
	"\114\372\245\342\004\271\017\200\342\373\313\145\326\141\142\000"
	"\254\075\224\344\004\372\072\330\256\144\356\342\206\266\150\144"
	"\206\255\013\173\307\242\054\131\224\322\060\263\047\110\022\050"
	"\333\043\260\326\261\133\146\260\066\106\173\076\176\246\027\247"
	"\162\221\203\020\050\162\301\361\123\065\352\347\257\311\033\135"
	"\377\210\302\042\034\352\256\174\020\004\114\367\013\243\062\030"
	"\110\024\244\155\025\147\236\365\034\226\360\207\302\213\222\340"
	"\143\042\307\263\307\077\153\066\272\163\300\222\265\250\140\201"
	"\116\377\101\257\256\227\175\112\022\272\150\374\135\306\225\072"
	"\305\236\014\234\256\354\260\020\205\353\367\204\271\253\235\261"
	"\004\051\116\352\237\045\156\045\145\231\375\127\141\062\133\132"
	"\263\351\011\051\121\152\213\267\055\130\053\146\066\344\043\113"
	"\332\001\154\024\216\246\262\067\037\265\172\243\307\327\074\044"
	"\233\136\230\176\207\241\066\055\163\367\106\124\045\251\305\230"
	"\254\051\201\061\174\345\210\235\137\031\274\073\063\232\055\234"
	"\277\257\007\227\301\030\020\162\242\364\075\375\354\011\340\241"
	"\124\272\341\130\136\030\071\341\317\070\116\034\173\141\361\377"
	"\227\305\357\304\057\027\032\141\326\010\246\065\003\323\142\034"
	"\336\120\253\254\105\230\370\115\016\120\062\262\225\100\232\205"
	"\214\076\073\153\302\236\015\151\267\131\066\320\075\315\000\037"
	"\016\355\102\246\340\006\214\377\213\151\326\270\040\244\003\222"
	"\022\145\232\346\221\120\343\166\112\110\134\242\003\362\365\042"
	"\306\351\153\033\347\037\170\067\124\101\237\123\055\047\331\230"
	"\162\315\322\013\073\230\276\201\342\310\172\052\127\257\124\112"
	"\236\357\207\204\140\363\335\147\200\156\122\310\214\263\246\244"
	"\133\062\323\113\252\221\131\142\044\154\316\171\365\170\024\062"
	"\251\054\150\011\250\154\230\162\067\305\057\015\012\002\353\013"
	"\252\311\053\071\360\354\061\116\024\056\047\021\230\170\116\243"
	"\132\343\342\073\345\030\164\340\033\270\134\234\144\370\133\132"
	"\357\160\271\207\354\145\027\313\273\151\176\222\065\011\065\026"
	"\243\107\332\032\307\261\344\162\156\300\325\033\336\161\242\064"
	"\145\255\117\050\322\246\211\352\263\342\376\251\304\072\163\002"
	"\055\217\327\075\027\304\257\145\170\114\070\055\015\100\036\007"
	"\033\223\314\104\255\375\004\313\360\107\041\011\147\215\070\361"
	"\026\117\241\101\323\041\123\154\015\220\273\036\007\212\054\165"
	"\344\077\355\124\363\140\043\341\310\160\346\074\043\005\275\021"
	"\246\045\231\162\130\330\210\027\022\341\316\106\034\312\332\223"
	"\350\375\361\057\012\126\351\274\342\057\344\300\223\062\365\016"
	"\042\247\213\120\143\163\003\324\126\255\102\327\056\335\172\246"
	"\047\132\042\142\374\164\224\047\231\321\353\161\372\107\141\131"
	"\056\337\140\365\161\062\374\365\137\313\010\022\365\264\242\340"
	"\341\345\337\231\221\155\145\362\372\147\314\020\365\270\150\204"
	"\303\171\150\042\026\240\114\072\007\374\333\023\041\250\203\112"
	"\136\305\153\002\355\043\024\047\264\156\117\150\327\000\057\101"
	"\124\220\131\160\331\335\235\035\152\230\310\274\116\313\104\015"
	"\061\326\205\231\267\251\167\152\335\226\317\060\235\170\227\372"
	"\045\225\332\074\147\066\063\006\255\144\061\336\266\223\167\023"
	"\255\223\360\021\347\102\143\140\176\154\020\002\043\233\300\337"
	"\130\320\331\160\113\377\140\253\333\241\055\227\376\125\057\247"
	"\016\060\122\065\337\145\125\002\304\103\164\235\314\010\313\116"
	"\020\301\015\047\157\234\363\365\344\036\070\307\326\341\201\200"
	"\176\225\044\213\354\253\243\307\372\362\120\331\007\077\261\055"
	"\244\350\344\126\255\334\050\211\267\147\344\274\054\362\171\004"
	"\103\134\333\046\340\230\270\126\071\002\343\105\074\233\236\035"
	"\002\306\157\113\234\163\162\225\222\151\323\216\344\202\306\320"
	"\264\225\123\346\357\201\012\352\375\061\241\223\106\276\377\276"
	"\045\352\072\060\335\161\326\301\016\067\267\051\107\113\335\122"
	"\023\053\013\132\367\016\124\216\103\361\316\144\025\215\226\105"
	"\322\141\000\266\312\034\355\111\051\056\142\265\036\301\134\305"
	"\367\363\132\155\342\303\361\075\171\276\213\125\205\203\162\302"
	"\247\115\034\347\137\362\126\063\132\361\360\204\177\106\121\330"
	"\011\273\076\041\321\153\304\241\137\161\132\146\004\023\327\303"
	"\255\067\173\001\336\031\303\324\061\031\267\272\005\223\203\367"
	"\340\372\345\230\163\151\141\066\220\166\315\302\056\260\337\252"
	"\351\332\031\072\007\113\341\353\340\271\144\272\234\045\162\267"
	"\232\026\216\024\237\032\201\263\304\040\215\123\012\117\244\003"
	"\054\172\234\000\020\041\242\302\152\102\303\212\100\274\230\211"
	"\065\055\200\211\063\164\201\111\020\025\320\350\370\326\321\006"
	"\214\074\276\357\244\330\137\115\322\251\255\147\170\220\200\146"
	"\045\261\060\075\236\274\002\157\254\004\365\231\175\046\111\106"
	"\011\014\035\172\004\167\173\127\112\363\325\353\257\302\061\355"
	"\022\367\022\035\372\222\317\013\332\167\170\005\273\252\262\157"
	"\112\155\103\370\004\247\275\161\127\106\273\356\361\316\110\365"
	"\166\001\234\362\264\003\374\135\073\146\165\114\023\264\375\125"
	"\242\021\074\270\353\211\170\101\255\017\104\131\047\020\162\212"
	"\315\343\302\112\167\274\237\157\057\236\212\203\326\376\064\353"
	"\156\170\262\016\362\065\153\223\261\140\136\213\133\215\334\162"
	"\274\037\132\327\274\344\335\235\140\364\327\273\361\315\326\253"
	"\200\015\242\064\226\070\052\121\360\115\075\063\226\303\037\342"
	"\053\353\061\344\336\260\077\331\370\115\064\037\066\203\176\353"
	"\222\217\227\345\275\210\157\203\324\154\114\023\074\035\025\037"
	"\041\343\073\221\371\375\037\217\224\315\315\124\375\134\145\115"
	"\150\231\123\064\341\303\037\311\233\233\012\151\031\175\151\120"
	"\340\142\254\305\005\316\274\344\263\156\334\315\066\072\122\015"
	"\257\104\175\224\305\011\263\014\152\030\052\206\341\247\256\276"
	"\073\342\237\344\301\377\271\146\147\016\237\270\011\000\217\000"
	"\004\327\256\025\333\072\032\257\007\363\167\316\012\014\142\101"
	"\207\323\302\350\246\354\261\034\334\132\306\140\064\101\217\064"
	"\140\043\104\034\145\347\344\171\155\343\342\356\046\225\034\122"
	"\174\322\205\023\130\377\152\342\053\306\376\341\324\063\372\311"
	"\141\077\121\001\324\157\321\144\050\254\236\265\073\201\337\142"
	"\207\057\307\252\051\370\214\310\064\104\354\146\167\331\131\105"
	"\157\241\253\075\322\132\147\272\130\332\136\105\115\131\255\377"
	"\102\057\065\253\316\327\042\120\216\152\121\260\167\013\276\303"
	"\315\237\171\201\041\134\152\114\062\016\214\360\136\302\167\307"
	"\046\114\033\171\236\233\261\137\340\327\315\273\115\331\137\153"
	"\201\115\222\136\346\335\057\100\074\361\343\335\120\111\374\211"
	"\240\147\111\273\135\017\217\020\176\214\131\307\262\174\222\312"
	"\334\174\161\057\121\242\317\216\265\340\346\240\373\003\373\267"
	"\075\234\366\003\351\014\023\146\257\175\026\124\346\007\072\031"
	"\313\163\251\247\351\230\112\007\167\201\352\024\102\017\256\216"
	"\347\116\053\027\307\113\026\067\077\025\231\245\356\301\162\265"
	"\042\175\176\171\027\354\345\206\133\043\377\110\172\154\164\205"
	"\052\337\023\262\316\307\067\225\011\233\222\146\121\015\166\111"
	"\137\215\260\121\243\221\201\025\030\261\325\175\041\266\372\071"
	"\314\356\177\005\202\036\276\260\123\267\307\376\327\217\151\102"
	"\172\331\264\071\352\232\370\002\214\145\366\326\200\266\236\273"
	"\244\344\070\322\332\300\120\230\003\171\021\014\221\037\017\313"
	"\100\223\135\174\326\054\334\000\215\014\136\146\006\107\302\222"
	"\107\072\270\324\211\200\232\004\016\072\320\337\125\034\141\230"
	"\313\331\175\364\235\241\130\202\037\021\077\123\052\053\322\074"
	"\225\002\250\020\143\221\147\255\310\000\272\023\012\277\261\015"
	"\050\005\070\020\274\050\061\212\215\114\024\030\037\311\243\337"
	"\352\005\365\125\300\221\260\164\060\046\231\100\200\322\102\354"
	"\305\026\175\137\173\301\216\246\263\220\125\107\245\374\171\174"
	"\025\076\351\055\214\350\001\126\263\355\305\017\032\020\015\336"
	"\065\170\241\310\074\115\335\111\262\050\364\043\347\360\027\135"
	"\203\000\377\051\135\344\360\112\373\165\306\262\137\275\230\033"
	"\114\001\363\205\203\047\267\107\362\226\016\262\336\162\167\214"
	"\155\023\006\275\076\107\341\112\046\070\006\056\103\221\057\003"
	"\241\152\233\115\312\277\321\046\134\251\035\124\111\362\152\221"
	"\227\067\040\155\361\363\372\370\064\205\057\163\060\377\137\225"
	"\101\316\061\252\320\271\061\104\302\212\152\025\073\325\276\305"
	"\004\320\231\024\065\111\056\026\117\335\210\210\123\074\175\243"
	"\076\364\040\107\200\137\156\035\140\212\261\367\224\374\215\201"
	"\032\227\227\323\065\341\320\260\071\132\233\316\030\337\315\135"
	"\166\247\060\346\250\275\250\353\305\210\050\203\023\306\152\124"
	"\123\043\062\006\226\070\026\125\304\067\330\135\054\170\063\355"
	"\027\255\132\313\120\274\164\206\176\021\154\107\174\022\041\232"
	"\204\060\026\315\106\316\312\057\065\066\335\373\267\113\224\253"
	"\257\330\137\125\256\041\145\170\324\220\223\072\203\023\255\364"
	"\072\017\064\023\244\141\173\214\156\057\320\174\211\033\201\033"
	"\162\323\022\066\153\120\050\354\241\270\244\074\314\262\260\307"
	"\103\265\076\256\242\230\141\021\267\316\270\204\225\107\007\151"
	"\240\213\004\131\240\230\225\266\255\104\010\033\360\050\253\044"
	"\351\101\363\072\237\354\026\151\326\216\120\337\022\342\052\123"
	"\320\253\122\267\211\365\257\015\102\002\151\354\250\266\252\207"
	"\212\000\314\056\215\057\346\125\071\277\334\356\332\015\272\112"
	"\164\032\303\251\120\211\205\157\367\251\176\311\300\103\361\013"
	"\167\036\021\037\226\242\054\247\354\142\004\335\365\272\132\303"
	"\106\031\030\136\363\306\373\314\234\045\044\230\326\104\367\265"
	"\342\205\216\034\262\120\050\014\045\266\031\241\211\120\215\126"
	"\341\120\116\000\307\053\040\273\126\115\301\355\060\220\232\027"
	"\273\102\035\021\144\156\113\302\200\353\213\016\103\171\214\334"
	"\077\122\117\300\037\045\323\335\150\276\030\334\227\324\201\233"
	"\101\151\374\334\111\232\074\120\057\340\067\233\001\245\313\033"
	"\047\115\236\317\365\013\310\232\005\036\255\136\273\220\176\215"
	"\323\036\302\026\213\066\132\016\066\063\311\060\332\044\217\225"
	"\136\205\213\360\312\203\205\267\105\001\270\005\206\011\217\201"
	"\314\357\065\147\152\230\066\031\316\166\373\272\137\077\011\211"
	"\141\310\226\213\167\027\231\205\337\242\176\245\051\061\056\322"
	"\141\217\042\215\357\124\374\105\010\066\106\264\250\307\100\123"
	"\046\357\107\203\071\367\034\227\033\325\200\275\000\042\254\121"
	"\165\324\122\350\170\077\117\163\154\214\276\136\136\113\040\333"
	"\065\230\070\330\377\303\274\340\102\265\313\166\316\067\001\321"
	"\074\173\273\070\325\300\325\301\151\376\271\170\217\052\355\345"
	"\335\132\111\370\263\326\267\264\256\060\165\047\357\071\173\261"
	"\215\236\013\032\166\263\053\015\010\221\302\107\357\260\046\315"
	"\365\211\115\153\050\221\010\367\175\156\066\070\114\375\263\116"
	"\154\336\366\313\043\136\241\121\073\161\150\342\200\217\250\305"
	"\031\351\012\135\374\007\002\250\153\056\237\356\011\120\353\325"
	"\350\334\223\112\076\102\124\214\176\205\045\207\301\022\347\107"
	"\347\355\007\044\000\242\227\052\206\367\000\375\170\373\373\073"
	"\057\214\321\256\335\315\322\070\024\271\053\164\232\264\153\143"
	"\337\320\256\041\263\003\043\334\306\240\204\013\007\301\155\361"
	"\343\016\131\121\311\172\273\276\314\375\262\014\362\227\273\170"
	"\003\355\174\015\166\167\026\343\142\152\121\054\247\203\147\362"
	"\173\130\376\003\040\107\236\355\044\075\224\104\314\122\014\040"
	"\203\151\026\374\154\010\315\130\140\215\154\153\327\173\104\210"
	"\244\240\023\214\327\337\220\075\226\271\135\226\020\162\171\217"
	"\363\203\132\176\036\267\251\333\241\233\376\045\106\076\257\141"
	"\263\332\005\370\121\222\253\365\102\270\014\320\212\246\273\207"
	"\205\074\005\201\224\127\144\330\132\324\212\045\002\272\235\202"
	"\254\113\351\344\205\051\316\066\060\223\376\352\272\254\170\006"
	"\253\116\063\220\205\032\126\076\363\020\054\057\043\200\064\306"
	"\005\131\355\241\350\100\207\127\240\010\310\022\136\046\224\334"
	"\333\331\221\017\105\225\331\215\144\324\207\113\377\146\342\223"
	"\247\266\203\210\027\362\256\331\312\356\141\316\117\161\346\124"
	"\114\247\321\022\366\356\051\047\230\324\121\346\027\070\173\365"
	"\277\246\102\147\260\214\311\354\363\046\175\101\304\334\223\312"
	"\105\156\161\062\121\226\045\100\367\005\115\000\106\321\201\132"
	"\234\366\363\025\236\355\233\223\274\152\236\345\051\100\114\317"
	"\063\146\001\147\072\145\255\225\210\127\307\300\175\007\024\064"
	"\352\162\176\072\364\005\250\017\004\276\206\230\241\237\045\053"
	"\365\146\374\126\155\266\230\143\021\064\267\320\076\321\305\346"
	"\360\215\027\134\011\045\142\073\052\227\367\136\133\162\114\161"
	"\231\020\036\263\004\040\014\040\023\013\311\040\232\322\133\045"
	"\366\266\250\367\160\141\273\151\331\363\206\360\124\375\046\257"
	"\336\115\302\016\114\224\013\303\045\101\266\052\106\007\217\311"
	"\113\266\077\366\216\315\166\302\057\313\274\206\121\130\314\353"
	"\212\115\057\177\156\264\044\324\213\013\133\114\360\306\203\262"
	"\305\353\163\333\246\224\377\321\174\007\240\241\354\317\156\167"
	"\364\335\100\027\322\033\350\274\334\251\261\237\225\372\114\137"
	"\157\077\320\037\167\056\255\370\024\335\025\121\366\150\366\112"
	"\265\324\317\017\224\005\350\110\125\052\331\207\000\252\343\320"
	"\267\137\220\050\054\101\242\272\013\313\352\014\176\370\043\037"
	"\227\264\304\147\070\070\155\102\276\322\042\264\112\161\211\241"
	"\055\063\114\305\112\224\174\036\073\365\121\241\314\176\342\157"
	"\276\130\252\242\213\306\140\374\152\123\277\046\220\124\325\122"
	"\015\052\330\047\014\357\016\270\127\324\021\331\161\367\250\140"
	"\121\146\165\166\067\024\330\003\171\075\133\304\115\156\134\206"
	"\107\152\262\112\142\331\324\312\227\351\137\250\070\257\010\243"
	"\043\343\336\376\153\373\007\320\315\157\263\200\257\130\156\022"
	"\072\134\164\151\177\245\362\132\251\222\271\176\116\353\171\174"
	"\274\140\152\356\354\222\324\265\135\234\056\230\067\330\011\325"
	"\063\274\121\257\123\035\354\225\154\213\155\264\117\217\024\153"
	"\307\047\146\142\312\252\007\052\361\350\010\166\015\034\251\171"
	"\271\144\304\177\165\127\372\076\073\364\214\015\107\026\170\040"
	"\010\035\313\236\173\154\305\351\003\201\321\366\064\320\122\232"
	"\213\250\306\077\374\225\223\033\101\365\367\252\130\254\020\322"
	"\166\200\205\014\011\173\001\014\012\042\336\046\344\237\241\050"
	"\057\174\166\275\137\054\260\334\112\305\272\234\123\133\374\300"
	"\130\316\227\220\320\300\234\333\342\173\001\306\032\243\356\112"
	"\040\145\007\177\221\267\133\334\175\026\170\320\162\165\221\312"
	"\104\050\133\024\351\367\357\313\163\361\222\216\224\201\330\264"
	"\346\340\063\170\230\217\124\025\245\315\346\027\103\167\342\207"
	"\240\075\234\211\065\214\125\250\175\347\066\021\151\017\306\120"
	"\357\371\310\207\210\035\235\056\353\203\105\056\372\047\266\232"
	"\145\122\043\232\336\171\102\133\140\171\155\312\210\063\032\170"
	"\054\343\000\265\000\235\344\353\041\051\032\033\121\320\266\266"
	"\042\332\120\000\123\223\134\264\014\311\176\225\374\231\016\051"
	"\174\016\337\175\254\303\151\315\355\204\351\077\124\237\366\167"
	"\172\107\170\315\332\324\201\347\235\000\174\232\232\212\304\027"
	"\231\243\224\105\147\376\023\125\202\375\224\327\235\212\116\027"
	"\321\306\345\254\233\147\223\071\147\020\323\001\232\227\031\064"
	"\073\256\171\243\254\215\370\057\212\214\007\047\027\125\077\351"
	"\034\044\225\267\213\050\360\363\070\304\365\323\133\016\007\227"
	"\274\201\072\151\016\062\230\231\277\237\301\326\365\000\277\021"
	"\045\124\311\260\175\271\244\266\175\231\211\331\247\220\161\144"
	"\022\253\315\040\336\146\272\235\006\173\164\374\174\063\015\241"
	"\210\326\122\006\220\366\274\015\217\106\347\067\327\130\233\351"
	"\003\151\012\342\320\304\200\326\077\364\322\273\050\340\135\261"
	"\267\257\267\107\245\164\125\065\272\074\155\221\224\011\172\230"
	"\162\204\173\103\111\373\032\210\360\355\104\030\315\242\312\205"
	"\121\201\315\367\365\042\055\260\137\232\101\364\244\274\215\027"
	"\101\010\132\212\004\164\023\364\141\130\014\057\372\327\264\114"
	"\130\202\104\116\245\161\377\004\014\100\371\260\375\206\310\076"
	"\217\042\311\223\227\334\207\370\064\224\050\057\153\335\174\304"
	"\137\300\023\004\062\022\010\077\123\002\360\120\210\270\217\030"
	"\333\130\254\162\064\064\152\151\310\223\231\064\160\025\371\317"
	"\325\015\323\010\037\334\107\162\336\070\303\147\360\122\200\313"
	"\253\054\075\337\140\250\111\051\073\342\136\254\367\127\173\315"
	"\144\117\325\204\053\035\367\012\125\273\162\106\015\362\021\270"
	"\037\117\230\177\367\341\251\063\304\007\337\273\137\133\211\304"
	"\252\137\111\326\174\100\341\322\373\124\030\011\107\051\302\146"
	"\171\132\346\161\074\217\244\001\227\204\274\366\340\106\273\212"
	"\245\004\141\042\104\103\364\100\227\014\111\336\066\013\105\260"
	"\146\054\041\243\273\305\244\123\112\141\111\052\247\005\265\115"
	"\011\027\157\116\132\144\216\361\161\330\320\250\344\026\130\113"
	"\102\171\356\376\077\223\121\211\364\233\264\234\240\152\352\252"
	"\201\131\370\333\276\207\315\057\137\236\327\104\264\060\217\367"
	"\251\175\365\350\021\107\162\005\342\047\242\203\221\214\055\023"
	"\346\046\356\244\255\274\324\015\132\253\121\017\333\340\007\205"
	"\136\375\156\157\104\341\165\047\010\027\252\232\244\330\255\212"
	"\376\234\057\254\131\003\271\264\257\013\303\213\354\313\021\112"
	"\310\177\271\014\140\057\063\151\106\336\004\353\266\261\166\265"
	"\116\245\142\247\251\034\133\131\047\037\344\023\352\365\135\262"
	"\165\027\277\326\106\363\077\215\321\103\171\210\365\357\075\104"
	"\225\237\354\077\274\110\230\343\147\175\367\122\163\125\005\350"
	"\154\304\276\263\267\376\101\211\102\272\021\070\252\117\174\077"
	"\357\150\176\253\260\027\216\030\224\205\153\007\332\160\360\107"
	"\065\257\373\355\255\074\166\357\367\207\047\241\327\244\341\306"
	"\015\140\161\276\170\377\326\014\205\102\024\140\262\005\247\347"
	"\264\243\325\141\340\113\121\327\323\171\171\252"
#define      msg1_z	65
#define      msg1	((&data[7108]))
	"\052\274\341\350\064\341\266\176\211\017\305\237\350\110\123\175"
	"\046\176\054\314\113\305\011\021\104\306\301\027\277\127\333\321"
	"\007\254\060\324\121\045\205\117\037\026\073\223\127\355\041\324"
	"\005\034\020\300\037\100\201\043\260\204\077\220\173\245\233\271"
	"\117\217\147\300\332\365\124\277\101\146\001\126\306\264"
#define      xecc_z	15
#define      xecc	((&data[7181]))
	"\017\063\246\273\043\001\166\360\015\326\343\071\232\371\155\354"
	"\022\161"
#define      lsto_z	1
#define      lsto	((&data[7198]))
	"\067"
#define      tst2_z	19
#define      tst2	((&data[7202]))
	"\074\104\072\200\353\007\237\311\215\177\126\067\217\263\056\076"
	"\061\170\205\256\071\251\131\237"
#define      chk2_z	19
#define      chk2	((&data[7225]))
	"\214\155\122\057\010\134\020\261\247\315\273\065\053\165\314\030"
	"\075\271\071\123\342\220"
#define      tst1_z	22
#define      tst1	((&data[7246]))
	"\324\367\040\110\022\025\073\123\225\311\251\200\014\074\016\000"
	"\274\365\027\070\127\035\336\057\050\233\343"
#define      chk1_z	22
#define      chk1	((&data[7272]))
	"\150\216\056\367\243\260\172\332\142\074\256\120\163\126\065\373"
	"\326\270\214\220\165\160\224\035\361"
#define      pswd_z	256
#define      pswd	((&data[7300]))
	"\310\332\076\242\250\056\157\324\377\263\061\107\111\301\070\154"
	"\057\135\204\025\135\004\035\347\106\036\051\034\113\064\270\310"
	"\127\164\153\000\242\332\325\242\215\007\352\327\311\043\103\371"
	"\200\310\016\336\315\053\305\024\112\356\060\225\043\351\136\173"
	"\135\311\173\000\243\121\243\061\130\215\011\042\260\115\033\061"
	"\025\051\017\342\125\325\366\237\304\046\065\347\017\223\143\155"
	"\135\337\155\000\060\020\062\211\236\073\253\116\210\306\177\235"
	"\357\217\177\104\144\166\344\051\234\031\020\254\255\164\031\012"
	"\123\207\013\203\230\075\015\066\170\270\205\000\176\004\236\156"
	"\224\035\263\370\223\230\041\060\261\062\335\136\246\367\151\372"
	"\176\164\176\027\261\213\115\051\103\323\052\302\327\310\061\153"
	"\346\344\144\172\174\206\253\056\271\210\215\137\177\366\132\376"
	"\152\330\025\033\143\143\105\247\066\160\151\016\070\232\172\037"
	"\177\336\232\374\145\105\053\036\316\270\176\115\256\330\113\030"
	"\260\141\064\024\304\172\273\373\352\045\011\043\300\203\102\077"
	"\142\334\074\307\042\147\345\360\037\143\076\316\073\212\347\354"
	"\353\034\001\004\036\171\136\276\044\342\032\261\120\253\037\175"
	"\176\364\254\247\220\220\053\233\020\277\270\001\305\307\260\215"
	"\242\356\222\300\150\360\177\215\323\232\076\043\106\136\241"
#define      date_z	1
#define      date	((&data[7600]))
	"\354"
#define      msg2_z	19
#define      msg2	((&data[7605]))
	"\226\176\355\125\231\307\345\042\156\377\062\212\372\127\306\035"
	"\177\115\271\140\306\227\036\066\357\033\376"
#define      shll_z	10
#define      shll	((&data[7629]))
	"\216\110\343\044\160\203\137\115\161\226\131\073"
#define      inlo_z	3
#define      inlo	((&data[7640]))
	"\265\032\223"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
